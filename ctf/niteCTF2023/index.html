<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/wednesday-acapella/libs/katex/katex.min.css"> <link rel=stylesheet  href="/wednesday-acapella/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/wednesday-acapella/css/franklin.css"> <link rel=stylesheet  href="/wednesday-acapella/css/tufte.css"> <link rel=stylesheet  href="/wednesday-acapella/css/latex.css"> <link rel=stylesheet  href="/wednesday-acapella/css/adjust.css"> <link rel=icon  href="/wednesday-acapella/assets/favicon.png"> <title>niteCTF 2023</title> <div id=layout > <div id=menu > <ul> <li><a href="/wednesday-acapella/">root</a> <li><a href="/wednesday-acapella/ctf/">ctf</a> </ul> </div> <div id=main > <div class=franklin-content ><h1 id=nitectf_2023 ><a href="#nitectf_2023" class=header-anchor >niteCTF 2023</a></h1> <h2 id=cha-cha-cha ><a href="#cha-cha-cha" class=header-anchor >cha-cha-cha</a></h2> <div class=franklin-toc ><ol><li><a href="#introduction">Introduction</a><li><a href="#finding_splitting_ciphertexts">Finding splitting ciphertexts</a><li><a href="#satisfying_padding_requirements">Satisfying padding requirements</a><li><a href="#implementation_in_julia">Implementation in Julia</a><li><a href="#flag">Flag</a></ol></div> <hr /> <h3 id=introduction ><a href="#introduction" class=header-anchor >Introduction</a></h3> <p>We are provided with a decryption oracle for ChaCha20Poly1305, and tasked with determining the oracle&#39;s key derivation secret in order to retrieve the flag.</p> <pre><code class="python hljs"><span class=hljs-keyword >import</span> os
<span class=hljs-keyword >from</span> cryptography.hazmat.backends <span class=hljs-keyword >import</span> default_backend
<span class=hljs-keyword >from</span> cryptography.hazmat.primitives.ciphers.aead <span class=hljs-keyword >import</span> ChaCha20Poly1305
<span class=hljs-keyword >from</span> cryptography.hazmat.primitives <span class=hljs-keyword >import</span> hashes
<span class=hljs-keyword >from</span> cryptography.hazmat.primitives.kdf.pbkdf2 <span class=hljs-keyword >import</span> PBKDF2HMAC
<span class=hljs-keyword >from</span> secret <span class=hljs-keyword >import</span> FLAG

TOKEN = <span class=hljs-string >&#x27;&#x27;</span>.join([<span class=hljs-string >&#x27;{:02x}&#x27;</span>.<span class=hljs-built_in >format</span>(byte) <span class=hljs-keyword >for</span> byte <span class=hljs-keyword >in</span> os.urandom(<span class=hljs-number >9</span>)])

<span class=hljs-keyword >def</span> <span class="hljs-title function_">get_tokens</span>():
    tokens = [<span class=hljs-built_in >str</span>(TOKEN[i:i+<span class=hljs-number >3</span>]) <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-number >0</span>, <span class=hljs-built_in >len</span>(TOKEN), <span class=hljs-number >3</span>)]
    <span class=hljs-keyword >return</span> tokens

<span class=hljs-keyword >def</span> <span class="hljs-title function_">derive_key</span>(<span class=hljs-params >token, iterations=<span class=hljs-number >100000</span>, key_length=<span class=hljs-number >32</span></span>):
    kdf = PBKDF2HMAC(
        algorithm=hashes.SHA256(),
        salt=<span class=hljs-string >b&#x27;CryPT0N1t3&#x27;</span>,
        length=key_length,
        iterations=iterations,
        backend=default_backend()
    )
    key = kdf.derive(token.encode())
    <span class=hljs-keyword >return</span> key

<span class=hljs-keyword >def</span> <span class="hljs-title function_">decrypt</span>(<span class=hljs-params >ciphertext, token_index</span>):
    nonce = ciphertext[:<span class=hljs-number >12</span>]
    ciphertext = ciphertext[<span class=hljs-number >12</span>:]
    key = derive_key(tokens[token_index])
    cipher = ChaCha20Poly1305(key)
    plaintext = cipher.decrypt(nonce, ciphertext, <span class=hljs-literal >None</span>)
    <span class=hljs-keyword >return</span> plaintext

<span class=hljs-keyword >def</span> <span class="hljs-title function_">main</span>():
    <span class=hljs-keyword >global</span> tokens
    <span class=hljs-keyword >global</span> token_index
    <span class=hljs-keyword >global</span> queries

    tokens = get_tokens()
    token_index = <span class=hljs-number >0</span>
    queries = <span class=hljs-number >0</span>

    <span class=hljs-keyword >while</span> queries &lt;= <span class=hljs-number >800</span>:
        <span class=hljs-built_in >print</span> (<span class=hljs-string >&quot;\nchoose an option:\n&quot;</span>)
        <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;1. select token&quot;</span>)
        <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;2. decrypt&quot;</span>)
        <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;3. get flag&quot;</span>)
        <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;4. exit&quot;</span>)

        option = <span class=hljs-built_in >input</span>(<span class=hljs-string >&quot;&gt;&gt;: &quot;</span>)

        <span class=hljs-keyword >if</span> option == <span class=hljs-string >&quot;1&quot;</span>:
            sel = <span class=hljs-built_in >int</span>(<span class=hljs-built_in >input</span>(<span class=hljs-string >&quot;\nselect a token (1-6)\n&gt;&gt;: &quot;</span>))
            <span class=hljs-keyword >if</span> <span class=hljs-number >1</span> &lt;= sel &lt;= <span class=hljs-number >6</span>:
                token_index = sel - <span class=hljs-number >1</span>
            <span class=hljs-keyword >else</span>:
                <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;invalid token index&quot;</span>)

        <span class=hljs-keyword >elif</span> option == <span class=hljs-string >&quot;2&quot;</span>:
            ciphertext = <span class=hljs-built_in >bytes</span>.fromhex(<span class=hljs-built_in >input</span>(<span class=hljs-string >&quot;ciphertext (hex): &quot;</span>))
            <span class=hljs-keyword >try</span>:
                pt = decrypt(ciphertext, token_index)
                <span class=hljs-built_in >print</span> (<span class=hljs-string >f&quot;decrypted (hex): <span class=hljs-subst >{pt.<span class=hljs-built_in >hex</span>()}</span>&quot;</span>)
            <span class=hljs-keyword >except</span>:
                <span class=hljs-built_in >print</span> (<span class=hljs-string >&quot;error decrypting&quot;</span>)

        <span class=hljs-keyword >elif</span> option == <span class=hljs-string >&quot;3&quot;</span>:
            entered_token = <span class=hljs-built_in >input</span>(<span class=hljs-string >&quot;enter token: &quot;</span>)
            <span class=hljs-keyword >if</span> entered_token == TOKEN:
                <span class=hljs-built_in >print</span>(<span class=hljs-string >f&quot;<span class=hljs-subst >{FLAG}</span>&quot;</span>)
                <span class=hljs-keyword >break</span>
            <span class=hljs-keyword >else</span>:
                <span class=hljs-built_in >print</span>(<span class=hljs-string >&quot;wrong token&quot;</span>)
                <span class=hljs-keyword >break</span>

        <span class=hljs-keyword >elif</span> option == <span class=hljs-string >&quot;4&quot;</span>:
            <span class=hljs-keyword >break</span>

        queries += <span class=hljs-number >1</span>

<span class=hljs-keyword >if</span> __name__ == <span class=hljs-string >&quot;__main__&quot;</span>:
    main()</code></pre> <p>The entire secret is 9 bytes &#40;72 bits&#41;, however we only need to submit guesses in 12 bit tokens. While it wouldn&#39;t take long to enumerate all 4096 possibilities for each token, we are prevented from doing so by the oracle&#39;s limit on the number of queries we&#39;re allowed to place.</p> <blockquote> <p>Whenever a linear search doesn&#39;t work, try binary</p> </blockquote> <p>What we can do instead is apply a partitioning oracle attack, following <a href="https://www.usenix.org/system/files/sec21summer_len.pdf">Len, Grubbs and Ristenpart</a>. Looking at the ChaCha20Poly1305 algorithm, we see that the validity of a ciphertext depends only on the validity of the Poly1305 tag <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> relative to the authentication inputs <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>A</mi><mi>D</mi><mo separator=true >,</mo><mi>K</mi><mo separator=true >,</mo><mi>N</mi><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(AD, K, N, C)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span></span></span></span> of which we control all but <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>.</p> <div class=splash_image ><img src="https://upload.wikimedia.org/wikipedia/commons/5/55/ChaCha20-Poly1305_Encryption.svg" alt=ChaCha20Poly1305  /></div> <p>Hence given two distinct keys <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">K_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">K_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, one hopes to manipulate the remaining inputs <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>A</mi><mi>D</mi><mo separator=true >,</mo><mi>N</mi><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(AD, N, C)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span></span></span></span> in such a way so as to make the tags</p> <div class=nonumber ><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.25em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><msub><mi>T</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mrow><mi mathvariant=normal >P</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >y</mi><mn>1305</mn></mrow><mo stretchy=false >(</mo><mi>A</mi><mi>D</mi><mo separator=true >,</mo><msub><mi>K</mi><mn>1</mn></msub><mo separator=true >,</mo><mi>N</mi><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><msub><mi>T</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mrow><mi mathvariant=normal >P</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >y</mi><mn>1305</mn></mrow><mo stretchy=false >(</mo><mi>A</mi><mi>D</mi><mo separator=true >,</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator=true >,</mo><mi>N</mi><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} T_1 &amp;= \mathrm{Poly1305}(AD, K_1, N, C)\\ T_2 &amp;= \mathrm{Poly1305}(AD, K_2, N, C) \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3em;vertical-align:-1.25em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.75em;"><span style="top:-3.91em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.25em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.75em;"><span style="top:-3.91em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mord mathrm">Poly1305</span></span><span class=mopen >(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span></span></span><span style="top:-2.41em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mord mathrm">Poly1305</span></span><span class=mopen >(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></div> <p>equal.</p> <p>If successful, we can treat the two keys as one when submitting to the oracle. Rejection of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>T</mi><mn>1</mn></msub><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(T_1, C)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span></span></span></span> entails rejection of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>T</mi><mn>2</mn></msub><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(T_2, C)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span></span></span></span>, allowing us to exclude both <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">K_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">K_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> as candidates with a single query. Generalising to simultaneous collisions involving <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> keys, we can carve away large portions of the key space with only a few queries.</p> <p>In practice, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">AD</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> are kept fixed at sensible defaults &#40;in our case empty and zero&#41; whilst <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> is manipulated to produce the desired effect. A successful ciphertext <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> is known as a <em>splitting ciphertext</em>, and the number of distinct keys for which it causes a tag collision is the splitting ciphertext&#39;s <em>degree</em>.</p> <p>Splitting ciphertexts of degree <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> partition the key space <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=script >K</mi></mrow><annotation encoding="application/x-tex">\mathcal{K}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.01445em;">K</span></span></span></span> into <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∣</mi><mi mathvariant=script >K</mi><mi mathvariant=normal >∣</mi><mi mathvariant=normal >/</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">|\mathcal{K}|/n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class="mord mathcal" style="margin-right:0.01445em;">K</span><span class=mord >∣/</span><span class="mord mathnormal">n</span></span></span></span> subsets. This allows determining the correct key in approximately <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∣</mi><mi mathvariant=script >K</mi><mi mathvariant=normal >∣</mi><mi mathvariant=normal >/</mi><mi>n</mi><mo>+</mo><msub><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn></msub><mo stretchy=false >(</mo><mi>n</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">|\mathcal{K}|/n + \log_2(n)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class="mord mathcal" style="margin-right:0.01445em;">K</span><span class=mord >∣/</span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop ><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.207em;"><span style="top:-2.4559em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2441em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">n</span><span class=mclose >)</span></span></span></span> queries compared to the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∣</mi><mi mathvariant=script >K</mi><mi mathvariant=normal >∣</mi></mrow><annotation encoding="application/x-tex">|\mathcal{K}|</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class="mord mathcal" style="margin-right:0.01445em;">K</span><span class=mord >∣</span></span></span></span> queries of a brute force search. In the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi mathvariant=normal >∣</mi><mi mathvariant=script >K</mi><mi mathvariant=normal >∣</mi><mi mathvariant=normal >/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">n = |\mathcal{K}|/2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class="mord mathcal" style="margin-right:0.01445em;">K</span><span class=mord >∣/2</span></span></span></span> case we recover classical binary search, however reaching high values of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span> for Poly1305 requires significant computational effort.</p> <h3 id=finding_splitting_ciphertexts ><a href="#finding_splitting_ciphertexts" class=header-anchor >Finding splitting ciphertexts</a></h3> <p>Given keys <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo separator=true >,</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi>K</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">K_1, K_2, \ldots,K_n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8778em;vertical-align:-0.1944em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, we seek a ciphertext <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> such that </p> <a id=eq1  class=anchor ></a><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mrow><mi mathvariant=normal >P</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >y</mi><mn>1305</mn></mrow><mo stretchy=false >(</mo><msub><mi>K</mi><mn>1</mn></msub><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo><mo>=</mo><mrow><mi mathvariant=normal >P</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >y</mi><mn>1305</mn></mrow><mo stretchy=false >(</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo><mo>=</mo><mo>…</mo><mo>=</mo><mrow><mi mathvariant=normal >P</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >y</mi><mn>1305</mn></mrow><mo stretchy=false >(</mo><msub><mi>K</mi><mi>n</mi></msub><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \mathrm{Poly1305}(K_1, C) = \mathrm{Poly1305}(K_2, C) = \ldots = \mathrm{Poly1305}(K_n, C). </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">Poly1305</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">Poly1305</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.3669em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">Poly1305</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span><span class=mord >.</span></span></span></span></span> <p>Suppose <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> is composed of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 16-byte blocks <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi>m</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">m_1, \ldots, m_m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and let <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">m_{\mathrm{meta}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> be a fixed metadata block containing ciphertext length information. If <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub><mo separator=true >,</mo><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i, r_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> are the &#40;clamped&#41; Poly1305 keys derived via ChaCha20 from <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">K_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, then </p> <div class=nonumber ><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mrow><mi mathvariant=normal >P</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >y</mi><mn>1305</mn></mrow><mo stretchy=false >(</mo><msub><mi>K</mi><mi>i</mi></msub><mo separator=true >,</mo><mi>C</mi><mo stretchy=false >)</mo><mo>=</mo><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><msub><mrow><mo fence=true >[</mo><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>k</mi></msub><mo stretchy=false >)</mo><msubsup><mi>r</mi><mi>i</mi><mi>k</mi></msubsup><mo fence=true >]</mo></mrow><mi>p</mi></msub></mrow><annotation encoding="application/x-tex"> \mathrm{Poly1305}(K_i, C) = s_i + \left[m_{\mathrm{meta}} + \sum_{k = 1}^m \mathrm{pad}(m_k) r_i^k \right]_p </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">Poly1305</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:3.2379em;vertical-align:-1.4879em;"></span><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-1.0504em;"><span style="top:-1.3482em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.4879em;"><span></span></span></span></span></span></span></span></span></span></span></div> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> is the prime <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>130</mn></msup><mo>−</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">2^{130} - 5</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8974em;vertical-align:-0.0833em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">130</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >5</span></span></span></span>. We see that Poly1305 deliberately sabotages its algebraic structure in two ways: first through the unreduced addition of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and second by requiring that its polynomial coefficients be padded by appending one byte beyond the number of octects. Sidestepping these issues for the moment, we can reduce <span class=eqref >(<a href="#eq1">1</a>)</span> modulo <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> to obtain a system of linear equations in <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=double-struck >F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.975em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathbb">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n - 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >1</span></span></span></span> constraints and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> unknowns</p> <div class=nonumber ><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.25em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>k</mi></msub><mo stretchy=false >)</mo><msubsup><mi>r</mi><mn>1</mn><mi>k</mi></msubsup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mn>2</mn></msub><mo>+</mo><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>k</mi></msub><mo stretchy=false >)</mo><msubsup><mi>r</mi><mn>2</mn><mi>k</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>+</mo><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>k</mi></msub><mo stretchy=false >)</mo><msubsup><mi>r</mi><mn>2</mn><mi>k</mi></msubsup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mn>3</mn></msub><mo>+</mo><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>k</mi></msub><mo stretchy=false >)</mo><msubsup><mi>r</mi><mn>3</mn><mi>k</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mi><mi mathvariant=normal >⋮</mi><mpadded height=0em  voffset=0em ><mspace mathbackground=black  width=0em  height=1.5em ></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><msub><mi>s</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>k</mi></msub><mo stretchy=false >)</mo><msubsup><mi>r</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>k</mi></msubsup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mi>s</mi><mi>n</mi></msub><mo>+</mo><msub><mi>m</mi><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>k</mi></msub><mo stretchy=false >)</mo><msubsup><mi>r</mi><mi>n</mi><mi>k</mi></msubsup><mi mathvariant=normal >.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} s_1 + m_{\mathrm{meta}} + \sum_{k = 1}^m \mathrm{pad}(m_k)r_1^k &amp;= s_2 + m_{\mathrm{meta}} + \sum_{k = 1}^m \mathrm{pad}(m_k) r_2^k\\ s_2 + m_{\mathrm{meta}} + \sum_{k = 1}^m \mathrm{pad}(m_k)r_2^k &amp;= s_3 + m_{\mathrm{meta}} + \sum_{k = 1}^m \mathrm{pad}(m_k) r_3^k\\ \vdots&amp;\\ s_{n-1} + m_{\mathrm{meta}} + \sum_{k = 1}^m \mathrm{pad}(m_k)r_{n-1}^k &amp;= s_n + m_{\mathrm{meta}} + \sum_{k = 1}^m \mathrm{pad}(m_k) r_n^k.\\ \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:11.9205em;vertical-align:-5.7103em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:6.2103em;"><span style="top:-8.2464em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.9929em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8907em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class=mord >⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:0.4207em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2083em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3053em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:5.7103em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:6.2103em;"><span style="top:-8.2103em;"><span class=pstrut  style="height:3.6514em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.9568em;"><span class=pstrut  style="height:3.6514em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8546em;"><span class=pstrut  style="height:3.6514em;"></span><span class=mord ><span class=mord ></span></span></span><span style="top:0.4568em;"><span class=pstrut  style="height:3.6514em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">meta</span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8991em;"><span style="top:-2.453em;margin-left:-0.0278em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord >.</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:5.7103em;"><span></span></span></span></span></span></span></span></span></span></span></span></div> <p>Assuming linear independence of the equations, this bounds <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m \geq n - 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >1</span></span></span></span> in order for the system to not be overdetermined. The solutions form an <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m - n -1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >1</span></span></span></span> dimensional subspace of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant=double-struck >F</mi><mi>p</mi><mi>m</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F}_p^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.072em;vertical-align:-0.3831em;"></span><span class=mord ><span class="mord mathbb">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span></p> <div class=nonumber ><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mrow><mo fence=true >[</mo><mtable rowspacing=0.16em  columnalign="center center center" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false >)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mi><mi mathvariant=normal >⋮</mi><mpadded height=0em  voffset=0em ><mspace mathbackground=black  width=0em  height=1.5em ></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>m</mi></msub><mo stretchy=false >)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo>=</mo><mi mathvariant=bold >p</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>−</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>t</mi><mi>k</mi></msub><msub><mi mathvariant=bold >v</mi><mi>k</mi></msub><mo separator=true >,</mo><mspace width=1em /><mi mathvariant=bold >p</mi><mo separator=true >,</mo><msub><mi mathvariant=bold >v</mi><mi mathvariant=bold >k</mi></msub><mo>∈</mo><msubsup><mi mathvariant=double-struck >F</mi><mi>p</mi><mi>m</mi></msubsup><mo separator=true >,</mo><msub><mi>t</mi><mi>k</mi></msub><mo>∈</mo><msub><mi mathvariant=double-struck >F</mi><mi>p</mi></msub><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \begin{bmatrix} &amp;\mathrm{pad}(m_1)&amp;\\ &amp;\vdots&amp;\\ &amp;\mathrm{pad}(m_m)&amp;\\ \end{bmatrix} = \mathbf{p} + \sum_{k = 1}^{m - n - 1}t_k\mathbf{v}_k, \quad \mathbf{p},\mathbf{v_k} \in \mathbb{F}_p^m, t_k \in \mathbb{F}_p. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:4.26em;vertical-align:-1.88em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.35em;"><span style="top:-1.95em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-3.097em;"><span class=pstrut  style="height:3.155em;"></span><span style="height:0.616em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style="top:-4.35em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.85em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.38em;"><span style="top:-5.04em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-3.18em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-1.98em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.88em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.38em;"><span style="top:-5.2275em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span><span style="top:-3.3675em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class=mord >⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.88em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.38em;"><span style="top:-5.04em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-3.18em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-1.98em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.88em;"><span></span></span></span></span></span></span></span><span class=mclose ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.35em;"><span style="top:-1.95em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-3.097em;"><span class=pstrut  style="height:3.155em;"></span><span style="height:0.616em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style="top:-4.35em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.85em;"><span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathbf">p</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:3.1032em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.0975em;vertical-align:-0.3831em;"></span><span class=mord ><span class="mord mathbb">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3831em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.975em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord mathbb">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mord >.</span></span></span></span></span></div> <h3 id=satisfying_padding_requirements ><a href="#satisfying_padding_requirements" class=header-anchor >Satisfying padding requirements</a></h3> <p>This is where algebraic sabotage comes into play. In order for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=bold >p</mi><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>−</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>t</mi><mi>k</mi></msub><msub><mi mathvariant=bold >v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{p} + \sum_{k = 1}^{m - n - 1}t_k\mathbf{v}_k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathbf">p</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.2537em;vertical-align:-0.2997em;"></span><span class=mop ><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to form a valid splitting ciphertext, each coordinate must lie in the image of the Poly1305 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><mo>⋅</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\mathrm{pad}(\cdot)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord >⋅</span><span class=mclose >)</span></span></span></span> operation. For 16-byte message blocks, this is equivalent to requiring that each <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\mathrm{pad}(m_i)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> be congruent to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> modulo <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> for some <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in the interval <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence=true >[</mo><msup><mn>2</mn><mn>128</mn></msup><mo separator=true >,</mo><msup><mn>2</mn><mn>129</mn></msup><mo fence=true >]</mo></mrow><annotation encoding="application/x-tex">\left[2^{128}, 2^{129}\right]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2em;vertical-align:-0.35em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">128</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">129</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span>.</p> <p>If coordinates were uniformly distributed, the probability of any one coordinate lying in the required interval is approximately <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant=normal >/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">1/4</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1/4</span></span></span></span>, so the probability of the padding requirement being satisfied by chance is approximately <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant=normal >/</mi><msup><mn>4</mn><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">1/4^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1/</span><span class=mord ><span class=mord >4</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span>. Using a generate-and-test method, splitting ciphertexts can be brute-forced for degrees up to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≈</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n \approx 10</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4831em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >≈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >10</span></span></span></span>, but chances diminish exponentially for higher values of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>. Moreover <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">n = 10</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >10</span></span></span></span> will not be sufficient for our use-case: splitting ciphertexts of degree <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >10</span></span></span></span> will require &#40;worst case&#41; approx. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>400</mn></mrow><annotation encoding="application/x-tex">400</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >400</span></span></span></span> queries to determine the applicable partition for each token, which exceeds our budget of 800 total queries across all six tokens.</p> <p>The idea for generating splitting ciphertexts of higher degree comes from <a href="https://www.kryptoslogic.com/blog/2021/01/faster-poly1305-key-multicollisions/">KryptosLogic</a>. First we lift our solution to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=double-struck >Z</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{Z}^{m}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6889em;"></span><span class=mord ><span class="mord mathbb">Z</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></span> by appending arbitrary linear combinations of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><msub><mi mathvariant=bold >e</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><mi>p</mi><msub><mi mathvariant=bold >e</mi><mi>m</mi></msub><mo>∈</mo><msup><mi mathvariant=double-struck >Z</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">p\mathbf{e}_1,\ldots,p\mathbf{e}_m \in \mathbb{Z}^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class=mord ><span class="mord mathbf">e</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class=mord ><span class="mord mathbf">e</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6889em;"></span><span class=mord ><span class="mord mathbb">Z</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span></p> <div class=nonumber ><span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mrow><mo fence=true >[</mo><mtable rowspacing=0.16em  columnalign="center center center" columnspacing=1em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy=false >)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mi><mi mathvariant=normal >⋮</mi><mpadded height=0em  voffset=0em ><mspace mathbackground=black  width=0em  height=1.5em ></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow><mrow><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><msub><mi>m</mi><mi>m</mi></msub><mo stretchy=false >)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=false ><mrow></mrow></mstyle></mtd></mtr></mtable><mo fence=true >]</mo></mrow><mo>=</mo><mi mathvariant=bold >p</mi><mo>+</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>−</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>t</mi><mi>k</mi></msub><msub><mi mathvariant=bold >v</mi><mi>k</mi></msub><mo>+</mo><mi>p</mi><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>t</mi><mi>k</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msubsup><msub><mi mathvariant=bold >e</mi><mi>k</mi></msub><mo separator=true >,</mo><mspace width=1em /><mi mathvariant=bold >p</mi><mo separator=true >,</mo><msub><mi mathvariant=bold >v</mi><mi mathvariant=bold >k</mi></msub><mo>∈</mo><msup><mi mathvariant=double-struck >Z</mi><mi>m</mi></msup><mo separator=true >,</mo><msub><mi>t</mi><mi>k</mi></msub><mo separator=true >,</mo><msubsup><mi>t</mi><mi>k</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msubsup><mo>∈</mo><mi mathvariant=double-struck >Z</mi><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \begin{bmatrix} &amp;\mathrm{pad}(m_1)&amp;\\ &amp;\vdots&amp;\\ &amp;\mathrm{pad}(m_m)&amp;\\ \end{bmatrix} = \mathbf{p} + \sum_{k = 1}^{m - n - 1}t_k\mathbf{v}_k + p\sum_{k=1}^{m}t&#x27;_k \mathbf{e}_k, \quad \mathbf{p},\mathbf{v_k} \in \mathbb{Z}^{m}, t_k,t&#x27;_k \in \mathbb{Z}. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:4.26em;vertical-align:-1.88em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.35em;"><span style="top:-1.95em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-3.097em;"><span class=pstrut  style="height:3.155em;"></span><span style="height:0.616em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style="top:-4.35em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.85em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.38em;"><span style="top:-5.04em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-3.18em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-1.98em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.88em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.38em;"><span style="top:-5.2275em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span><span style="top:-3.3675em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class=mord >⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1675em;"><span class=pstrut  style="height:3.6875em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">pad</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">m</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.88em;"><span></span></span></span></span></span><span class=arraycolsep  style="width:0.5em;"></span><span class=arraycolsep  style="width:0.5em;"></span><span class=col-align-c ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.38em;"><span style="top:-5.04em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-3.18em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span><span style="top:-1.98em;"><span class=pstrut  style="height:3.5em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.88em;"><span></span></span></span></span></span></span></span><span class=mclose ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.35em;"><span style="top:-1.95em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-3.097em;"><span class=pstrut  style="height:3.155em;"></span><span style="height:0.616em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style="top:-4.35em;"><span class=pstrut  style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.85em;"><span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathbf">p</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:3.1032em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8011em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mord mathnormal">p</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8019em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathbf">e</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathbf">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.0489em;vertical-align:-0.247em;"></span><span class=mord ><span class="mord mathbb">Z</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8019em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.247em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6889em;"></span><span class="mord mathbb">Z</span><span class=mord >.</span></span></span></span></span></div> <p>The vectors <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi mathvariant=bold >v</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msub><mi mathvariant=bold >v</mi><mrow><mi>m</mi><mo>−</mo><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator=true >,</mo><mi>p</mi><msub><mi mathvariant=bold >e</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><mi>p</mi><msub><mi mathvariant=bold >e</mi><mi>m</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{v}_1,\ldots,\mathbf{v}_{m - n - 1}, p\mathbf{e}_1, \ldots, p\mathbf{e}_m)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2083em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class=mord ><span class="mord mathbf">e</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class=mord ><span class="mord mathbf">e</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> then span a lattice <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>⊆</mo><msup><mi mathvariant=double-struck >Z</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">L \subseteq \mathbb{Z}^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal">L</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >⊆</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6889em;"></span><span class=mord ><span class="mord mathbb">Z</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span>, and so the problem of finding vectors with coordinates in the interval <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence=true >[</mo><msup><mn>2</mn><mn>128</mn></msup><mo separator=true >,</mo><msup><mn>2</mn><mn>129</mn></msup><mo fence=true >]</mo></mrow><annotation encoding="application/x-tex">\left[2^{128}, 2^{129}\right]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2em;vertical-align:-0.35em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">128</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">129</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span> becomes equivalent to finding vectors in <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span> sufficiently close to the midpoint vector <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msup><mn>2</mn><mn>128</mn></msup><mo>+</mo><msup><mn>2</mn><mn>127</mn></msup><mo separator=true >,</mo><mo>…</mo><mo separator=true >,</mo><msup><mn>2</mn><mn>128</mn></msup><mo>+</mo><msup><mn>2</mn><mn>127</mn></msup><mo stretchy=false >)</mo><mo>∈</mo><msup><mi mathvariant=double-struck >Z</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">(2^{128} + 2^{127}, \ldots, 2^{128} + 2^{127}) \in \mathbb{Z}^m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0641em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">128</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.0085em;vertical-align:-0.1944em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">127</span></span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner >…</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">128</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.0641em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">127</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6889em;"></span><span class=mord ><span class="mord mathbb">Z</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span></span></span>. This is an instance of the <a href="https://en.wikipedia.org/wiki/Lattice_problem#Closest_vector_problem_&#40;CVP&#41;">closest vector problem</a>, which can be solved for reasonable values of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> by implementations such as <code><a href="https://github.com/fplll/fplll">fplll</a></code>. In particular <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>≥</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">m \geq 32</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >32</span></span></span></span> will be sufficient for our purposes.</p> <h3 id=implementation_in_julia ><a href="#implementation_in_julia" class=header-anchor >Implementation in Julia</a></h3> <p>Julia doesn&#39;t have a native ChaCha20Poly1305 implementation, so we&#39;ll be implementing parts of the algorithm according to <a href="https://datatracker.ietf.org/doc/html/rfc7539">RFC 7539</a> ourselves.</p> <p>First, we have the ChaCha20 section of the algorithm.</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> quarter_round(a::<span class=hljs-built_in >UInt32</span>, b::<span class=hljs-built_in >UInt32</span>, c::<span class=hljs-built_in >UInt32</span>, d::<span class=hljs-built_in >UInt32</span>)
    a += b; d ⊻= a; d = bitrotate(d, <span class=hljs-number >16</span>);
    c += d; b ⊻= c; b = bitrotate(b, <span class=hljs-number >12</span>);
    a += b; d ⊻= a; d = bitrotate(d, <span class=hljs-number >8</span>);
    c += d; b ⊻= c; b = bitrotate(b, <span class=hljs-number >7</span>);

  a, b, c, d
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> quarter_round!(state::<span class=hljs-built_in >AbstractMatrix</span>{<span class=hljs-built_in >UInt32</span>}, a_idx, b_idx, c_idx, d_idx)
  state[a_idx], state[b_idx], state[c_idx], state[d_idx] =
    quarter_round(state[a_idx], state[b_idx], state[c_idx], state[d_idx])

  state
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> chacha20_block_checkdims(key, nonce, block_count)
  <span class=hljs-keyword >if</span> sizeof(key) * <span class=hljs-number >8</span> != <span class=hljs-number >256</span> || sizeof(nonce) * <span class=hljs-number >8</span> != <span class=hljs-number >96</span> || sizeof(block_count) * <span class=hljs-number >8</span> != <span class=hljs-number >32</span>
    <span class=hljs-literal >false</span>
  <span class=hljs-keyword >end</span>

  <span class=hljs-literal >true</span>
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> chacha20_block_init_state(
  key::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  nonce::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  block_count::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
)
  key = reinterpret(<span class=hljs-built_in >UInt32</span>, key)
  nonce = reinterpret(<span class=hljs-built_in >UInt32</span>, nonce)
  block_count = reinterpret(<span class=hljs-built_in >UInt32</span>, block_count)

  <span class=hljs-built_in >UInt32</span>[
    <span class=hljs-number >0x61707865</span> <span class=hljs-number >0x3320646e</span> <span class=hljs-number >0x79622d32</span> <span class=hljs-number >0x6b206574</span>
    transpose(key[<span class=hljs-number >1</span>:<span class=hljs-number >4</span>])
    transpose(key[<span class=hljs-number >5</span>:<span class=hljs-number >8</span>])
    transpose(block_count) transpose(nonce)
  ]
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> chacha20_block(
  key::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  nonce::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  block_count::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
)
  chacha20_block_checkdims(key, nonce, block_count) || throw(
    <span class=hljs-built_in >ArgumentError</span>(
      <span class=hljs-string >&quot;Expected 256 bit key, 96 bit nonce, 32 bit block_count, passed as 32-bit little endian integers&quot;</span>,
    ),
  )

  state = chacha20_block_init_state(key, nonce, block_count)
  working_state = copy(state)
  rm_view = transpose(working_state) <span class=hljs-comment ># row-major indexed matrix</span>
  <span class=hljs-keyword >for</span> _ = <span class=hljs-number >1</span>:<span class=hljs-number >10</span>
    chacha20_block_innerblock!(rm_view)
  <span class=hljs-keyword >end</span>
  state += working_state

  serialize(state)
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> chacha20_block_innerblock!(rm_view::<span class=hljs-built_in >AbstractMatrix</span>{<span class=hljs-built_in >UInt32</span>})
  <span class=hljs-comment ># using 1-based row-major indexes</span>
  quarter_round!(rm_view, <span class=hljs-number >1</span>, <span class=hljs-number >5</span>, <span class=hljs-number >9</span>, <span class=hljs-number >13</span>)
  quarter_round!(rm_view, <span class=hljs-number >2</span>, <span class=hljs-number >6</span>, <span class=hljs-number >10</span>, <span class=hljs-number >14</span>)
  quarter_round!(rm_view, <span class=hljs-number >3</span>, <span class=hljs-number >7</span>, <span class=hljs-number >11</span>, <span class=hljs-number >15</span>)
  quarter_round!(rm_view, <span class=hljs-number >4</span>, <span class=hljs-number >8</span>, <span class=hljs-number >12</span>, <span class=hljs-number >16</span>)
  quarter_round!(rm_view, <span class=hljs-number >1</span>, <span class=hljs-number >6</span>, <span class=hljs-number >11</span>, <span class=hljs-number >16</span>)
  quarter_round!(rm_view, <span class=hljs-number >2</span>, <span class=hljs-number >7</span>, <span class=hljs-number >12</span>, <span class=hljs-number >13</span>)
  quarter_round!(rm_view, <span class=hljs-number >3</span>, <span class=hljs-number >8</span>, <span class=hljs-number >9</span>, <span class=hljs-number >14</span>)
  quarter_round!(rm_view, <span class=hljs-number >4</span>, <span class=hljs-number >5</span>, <span class=hljs-number >10</span>, <span class=hljs-number >15</span>)
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> serialize(chacha_state::<span class=hljs-built_in >AbstractMatrix</span>{<span class=hljs-built_in >UInt32</span>})
  reshape(reinterpret(<span class=hljs-built_in >UInt8</span>, transpose(chacha_state)), <span class=hljs-number >64</span>)
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> chacha20(
  key::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  block_count::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  nonce::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  plaintext::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
)
  chacha20_block_checkdims(key, nonce, block_count)
  base_count = only(reinterpret(<span class=hljs-built_in >UInt32</span>, block_count))
  encrypted_message = <span class=hljs-built_in >UInt8</span>[]
  <span class=hljs-keyword >for</span> (i::<span class=hljs-built_in >UInt32</span>, message_block) <span class=hljs-keyword >in</span> enumerate(Iterators.partition(plaintext, <span class=hljs-number >64</span>))
    counter = reinterpret(<span class=hljs-built_in >UInt8</span>, [base_count + (i - one(<span class=hljs-built_in >UInt32</span>))])
    key_stream = chacha20_block(key, nonce, counter)
    block = collect(x ⊻ y <span class=hljs-keyword >for</span> (x, y) <span class=hljs-keyword >in</span> zip(key_stream, message_block))
    append!(encrypted_message, block)
  <span class=hljs-keyword >end</span>

  encrypted_message
<span class=hljs-keyword >end</span></code></pre> <p>Next we have the Poly1305 section</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> AbstractAlgebra

<span class=hljs-keyword >const</span> P = <span class=hljs-built_in >BigInt</span>(<span class=hljs-number >2</span>)^<span class=hljs-number >130</span> - <span class=hljs-number >5</span>
<span class=hljs-keyword >const</span> F_p = GF(P)

<span class=hljs-keyword >function</span> poly1305_clamp!(r::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>})
  <span class=hljs-comment ># 1-based index again</span>
  r[<span class=hljs-number >4</span>] &amp;= <span class=hljs-number >0x0f</span>
  r[<span class=hljs-number >8</span>] &amp;= <span class=hljs-number >0x0f</span>
  r[<span class=hljs-number >12</span>] &amp;= <span class=hljs-number >0x0f</span>
  r[<span class=hljs-number >16</span>] &amp;= <span class=hljs-number >0x0f</span>

  r[<span class=hljs-number >5</span>] &amp;= <span class=hljs-number >0xfc</span>
  r[<span class=hljs-number >9</span>] &amp;= <span class=hljs-number >0xfc</span>
  r[<span class=hljs-number >13</span>] &amp;= <span class=hljs-number >0xfc</span>

  r
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> poly1305_checkdims(key)
  <span class=hljs-keyword >if</span> sizeof(key) * <span class=hljs-number >8</span> != <span class=hljs-number >256</span>
    <span class=hljs-literal >false</span>
  <span class=hljs-keyword >end</span>

  <span class=hljs-literal >true</span>
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> poly1305_prepare_key(key::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>})
  r, s = key[<span class=hljs-number >1</span>:<span class=hljs-number >16</span>], key[<span class=hljs-number >17</span>:<span class=hljs-keyword >end</span>]
  poly1305_clamp!(r)
  r = F_p(only(reinterpret(<span class=hljs-built_in >UInt128</span>, r)))
  s = <span class=hljs-built_in >BigInt</span>(only(reinterpret(<span class=hljs-built_in >UInt128</span>, s)))

  <span class=hljs-keyword >return</span> r, s
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> poly1305_poly(message::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>}, r::FinFieldElem)
  acc = zero(F_p)

  <span class=hljs-keyword >for</span> m <span class=hljs-keyword >in</span> Iterators.partition(message, <span class=hljs-number >16</span>)
    n = evalpoly(F_p(<span class=hljs-number >256</span>), [m; [<span class=hljs-number >0x01</span>]])
    acc += n
    acc *= r
  <span class=hljs-keyword >end</span>

  acc
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> poly1305(key::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>}, message::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>})
  poly1305_checkdims(key) || throw(
    <span class=hljs-built_in >ArgumentError</span>(
      <span class=hljs-string >&quot;Expected 256 bit key, 96 bit nonce, 32 bit block_count, passed as 32-bit little endian integers&quot;</span>,
    ),
  )

  r, s = poly1305_prepare_key(key)

  acc = poly1305_poly(message, r)
  acc = lift(acc) + s

  lower128 = acc &amp; ~<span class=hljs-built_in >UInt128</span>(<span class=hljs-number >0</span>)

  convert.(<span class=hljs-built_in >UInt8</span>, digits(lower128, base = <span class=hljs-number >256</span>, pad = <span class=hljs-number >16</span>))
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> poly1305_key_gen(key::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>}, nonce::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>})
  counter = reinterpret(<span class=hljs-built_in >UInt8</span>, [<span class=hljs-number >0x00000000</span>])
  block = chacha20_block(key, nonce, counter)

  block[<span class=hljs-number >1</span>:<span class=hljs-number >32</span>]          <span class=hljs-comment ># first 256 bits</span>
<span class=hljs-keyword >end</span></code></pre> <p>And finally the two composed together.</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> aead_chacha20_poly1305(
  key::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  nonce::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  plaintext::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
  aad::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >UInt8</span>},
)
  poly1305_key = poly1305_key_gen(key, nonce)
  counter = reinterpret(<span class=hljs-built_in >UInt8</span>, [<span class=hljs-number >0x00000001</span>])
  ciphertext = chacha20(key, counter, nonce, plaintext)

  message = aead_chacha20_poly1305_message_construct(ciphertext, aad)
  tag = poly1305(poly1305_key, message)

  <span class=hljs-keyword >return</span> tag, ciphertext
<span class=hljs-keyword >end</span></code></pre> <p>Julia doesn&#39;t seem to have a PBKDF2HMAC implementation either, so let&#39;s quickly enumerate the 12-bit key space</p> <pre><code class="python hljs"><span class=hljs-keyword >import</span> itertools
<span class=hljs-keyword >from</span> cryptography.hazmat.backends <span class=hljs-keyword >import</span> default_backend
<span class=hljs-keyword >from</span> cryptography.hazmat.primitives.ciphers.aead <span class=hljs-keyword >import</span> ChaCha20Poly1305
<span class=hljs-keyword >from</span> cryptography.hazmat.primitives <span class=hljs-keyword >import</span> hashes
<span class=hljs-keyword >from</span> cryptography.hazmat.primitives.kdf.pbkdf2 <span class=hljs-keyword >import</span> PBKDF2HMAC

TOKENS = [<span class=hljs-string >&quot;{:03x}&quot;</span>.<span class=hljs-built_in >format</span>(byte) <span class=hljs-keyword >for</span> byte <span class=hljs-keyword >in</span> <span class=hljs-built_in >range</span>(<span class=hljs-built_in >pow</span>(<span class=hljs-number >2</span>, <span class=hljs-number >12</span>))]
<span class=hljs-keyword >def</span> <span class="hljs-title function_">derive_key</span>(<span class=hljs-params >token, iterations=<span class=hljs-number >100000</span>, key_length=<span class=hljs-number >32</span></span>):
    kdf = PBKDF2HMAC(
        algorithm=hashes.SHA256(),
        salt=<span class=hljs-string >b&quot;CryPT0N1t3&quot;</span>,
        length=key_length,
        iterations=iterations,
        backend=default_backend(),
    )
    key = kdf.derive(token.encode())
    <span class=hljs-keyword >return</span> key

<span class=hljs-keyword >with</span> <span class=hljs-built_in >open</span>(<span class=hljs-string >&quot;keys.txt&quot;</span>, <span class=hljs-string >&quot;w&quot;</span>) <span class=hljs-keyword >as</span> fp:
    <span class=hljs-keyword >for</span> tok <span class=hljs-keyword >in</span> TOKENS:
        key = derive_key(tok)
        fp.write(<span class=hljs-string >&quot;[&quot;</span> + <span class=hljs-string >&quot;,&quot;</span>.join(<span class=hljs-string >&quot;0x{:02x}&quot;</span>.<span class=hljs-built_in >format</span>(x) <span class=hljs-keyword >for</span> x <span class=hljs-keyword >in</span> key) + <span class=hljs-string >&quot;]&quot;</span> + <span class=hljs-string >&quot;\n&quot;</span>)</code></pre> <p>and pass it through in a file</p> <pre><code class="julia hljs"><span class=hljs-keyword >struct</span> Key
  raw::<span class=hljs-built_in >String</span>           <span class=hljs-comment ># e.g &quot;20a&quot;, &quot;6fe&quot;</span>
  hashed::<span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >UInt8</span>} <span class=hljs-comment ># 32 bits</span>
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >const</span> KEYS = map(enumerate(eachline(open(<span class=hljs-string >&quot;keys.txt&quot;</span>)))) <span class=hljs-keyword >do</span> (i, line)
  raw = string(i - <span class=hljs-number >1</span>, base = <span class=hljs-number >16</span>, pad = <span class=hljs-number >3</span>)
  hashed = Meta.eval(Meta.parse(line))
  Key(raw, hashed)
<span class=hljs-keyword >end</span></code></pre> <p>Next we partition the key space into a forest of binary trees. Since we can compute splitting ciphertexts of degree <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">n = 32</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >32</span></span></span></span>, each tree will contain 32 keys.</p> <pre><code class="julia hljs"><span class=hljs-keyword >struct</span> Ciphertext
  tag::<span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >UInt8</span>}
  nonce::<span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >UInt8</span>}
  ciphertext::<span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >UInt8</span>}
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >mutable struct</span> TreeNode
  splitting::Ciphertext
  keys::<span class=hljs-built_in >AbstractVector</span>{Key}
  lo::<span class=hljs-built_in >Union</span>{TreeNode,<span class=hljs-built_in >Nothing</span>}
  hi::<span class=hljs-built_in >Union</span>{TreeNode,<span class=hljs-built_in >Nothing</span>}
<span class=hljs-keyword >end</span>

forest = []

<span class=hljs-keyword >for</span> keys <span class=hljs-keyword >in</span> Iterators.partition(KEYS, <span class=hljs-number >32</span>)
  splitting_ciphertext = find_collision(keys)
  tree = TreeNode(splitting_ciphertext, keys, <span class=hljs-literal >nothing</span>, <span class=hljs-literal >nothing</span>)
  push!(forest, tree)
<span class=hljs-keyword >end</span>

stck = copy(forest)
<span class=hljs-keyword >while</span> !isempty(stck)
  tree = pop!(stck)

  <span class=hljs-keyword >if</span> length(tree.keys) &lt;= <span class=hljs-number >1</span>
    <span class=hljs-keyword >continue</span>
  <span class=hljs-keyword >end</span>

  mid = cld(length(tree.keys), <span class=hljs-number >2</span>)
  lokeys, hikeys = tree.keys[<span class=hljs-number >1</span>:mid], tree.keys[mid+<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>]

  <span class=hljs-keyword >if</span> !isempty(lokeys)
    losplit = find_collision(lokeys)
    tree.lo = TreeNode(losplit, lokeys, <span class=hljs-literal >nothing</span>, <span class=hljs-literal >nothing</span>)
    push!(stck, tree.lo)
  <span class=hljs-keyword >end</span>

  <span class=hljs-keyword >if</span> !isempty(hikeys)
    hisplit = find_collision(hikeys)
    tree.hi = TreeNode(hisplit, hikeys, <span class=hljs-literal >nothing</span>, <span class=hljs-literal >nothing</span>)
    push!(stck, tree.hi)
  <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span></code></pre> <p>The <code>find_collision</code> function generates a splitting ciphertext by setting up the system of equations and solving the corresponding lattice problem</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> find_collision(keys::<span class=hljs-built_in >AbstractVector</span>{Key})
  find_collision(getfield.(keys, :hashed))
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># `redundancy` parameter controls how much `m` exceeds `n`, i.e `redundancy` = m - n</span>
<span class=hljs-keyword >function</span> find_collision(keys::<span class=hljs-built_in >AbstractVector</span>{<span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >UInt8</span>}}; redundancy = <span class=hljs-number >0</span>)
  <span class=hljs-keyword >if</span> length(keys) == <span class=hljs-number >1</span>
    <span class=hljs-keyword >return</span> random_ciphertext(only(keys))
  <span class=hljs-keyword >end</span>

  poly1305_keys = map(Base.Fix2(poly1305_key_gen, NONCE), keys)
  r_s = poly1305_prepare_key.(poly1305_keys)
  r, s = first.(r_s), last.(r_s)

  <span class=hljs-comment ># Last 16 byte block is a constant metadata block</span>
  num_ciphertext_blocks = length(keys) + redundancy
  aad_length = reinterpret(<span class=hljs-built_in >UInt8</span>, [length(AAD)])
  ciphertext_length = reinterpret(<span class=hljs-built_in >UInt8</span>, [<span class=hljs-number >16</span> * num_ciphertext_blocks])
  metadata_block = [aad_length; ciphertext_length]

  <span class=hljs-comment ># RHS of linear system</span>
  b = [
    F_p(s[i] - s[i-<span class=hljs-number >1</span>]) - evalpoly(F_p(<span class=hljs-number >256</span>), [metadata_block; [<span class=hljs-number >0x01</span>]]) * (r[i-<span class=hljs-number >1</span>] - r[i])
    <span class=hljs-keyword >for</span> i = <span class=hljs-number >2</span>:length(keys)
  ]
  b = matrix(F_p, reshape(b, :, <span class=hljs-number >1</span>))

  <span class=hljs-comment ># LHS of linear system</span>
  A = [[(r[i-<span class=hljs-number >1</span>]^j - r[i]^j) <span class=hljs-keyword >for</span> j = (num_ciphertext_blocks+<span class=hljs-number >1</span>):-<span class=hljs-number >1</span>:<span class=hljs-number >2</span>] <span class=hljs-keyword >for</span> i = <span class=hljs-number >2</span>:length(keys)]
  A = matrix(F_p, stack(A; dims = <span class=hljs-number >1</span>))

  particular_sol = AbstractAlgebra.solve(A, b)
  nullity, homogenous_sol = nullspace(A)
  d = length(particular_sol)

  <span class=hljs-comment ># Solution is a subspace of Fp^n. Lift solution to ZZ by appending (e1, e2, ..., e_d) to the basis</span>
  particular_sol = lift.(<span class=hljs-built_in >Matrix</span>(particular_sol))
  homogenous_sol = [
    lift.(<span class=hljs-built_in >Matrix</span>(homogenous_sol)) P*diagm(ones(<span class=hljs-built_in >Int64</span>, d))
  ]

  <span class=hljs-comment ># LLL-reduce lattice basis</span>
  reduced_basis = open(<span class=hljs-string >`fplll`</span>; read = <span class=hljs-literal >true</span>, write = <span class=hljs-literal >true</span>) <span class=hljs-keyword >do</span> fplll
    write(fplll, to_fplll(transpose(homogenous_sol))) <span class=hljs-comment ># Transpose because fplll expects row vectors</span>
    reduced_basis = read(fplll, <span class=hljs-built_in >String</span>)
    
    <span class=hljs-comment ># First row is all zeros since we have nvectors &gt; ndims. Remove it.</span>
    reduced_basis = <span class=hljs-string >&quot;[&quot;</span> * join(split(reduced_basis, <span class=hljs-string >&quot;\n&quot;</span>)[(<span class=hljs-number >2</span>+redundancy):<span class=hljs-keyword >end</span>]) 
  <span class=hljs-keyword >end</span>

  <span class=hljs-comment ># Solve CVP</span>
  midpoint = fill(big(<span class=hljs-number >2</span>)^<span class=hljs-number >128</span> + big(<span class=hljs-number >2</span>)^<span class=hljs-number >127</span>, d)
  target = to_fplll(reshape(midpoint - particular_sol, :))

  closest_vector = open(<span class=hljs-string >`fplll -a cvp`</span>; read = <span class=hljs-literal >true</span>, write = <span class=hljs-literal >true</span>) <span class=hljs-keyword >do</span> cvp
    write(cvp, reduced_basis * target)
    closest = from_fplll(read(cvp, <span class=hljs-built_in >String</span>))
  <span class=hljs-keyword >end</span>
  solution = mod.(particular_sol + closest_vector, P)

  <span class=hljs-comment ># Generate a ciphertext from the CVP solution</span>
  ciphertext = <span class=hljs-built_in >UInt8</span>[]
  <span class=hljs-keyword >for</span> block <span class=hljs-keyword >in</span> solution
    ciphertext_block = <span class=hljs-built_in >UInt8</span>.(digits(block; base = <span class=hljs-number >256</span>, pad = <span class=hljs-number >17</span>)[<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>])
    append!(ciphertext, ciphertext_block)
  <span class=hljs-keyword >end</span>

  <span class=hljs-comment ># We could still be off by a factor of p because of the unreduced addition of s in Poly1305.</span>
  <span class=hljs-comment ># If that&#x27;s the case, we&#x27;ll just generate a new splitting ciphertext by increasing the redundancy factor.</span>
  message = aead_chacha20_poly1305_message_construct(ciphertext, AAD)
  tag = unique(poly1305(key, message) <span class=hljs-keyword >for</span> key <span class=hljs-keyword >in</span> poly1305_keys)
  <span class=hljs-keyword >if</span> length(tag) &gt; <span class=hljs-number >1</span>
    <span class=hljs-keyword >return</span> find_collision(keys; redundancy = redundancy + <span class=hljs-number >1</span>)
  <span class=hljs-keyword >else</span>
    tag = only(tag)
    <span class=hljs-keyword >return</span> Ciphertext(tag, NONCE, ciphertext)
  <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> random_ciphertext(key)
  ct = rand(<span class=hljs-built_in >UInt8</span>, <span class=hljs-number >16</span>)
  poly1305_key = poly1305_key_gen(key, NONCE)
  message = aead_chacha20_poly1305_message_construct(ct, AAD)
  tag = poly1305(poly1305_key, message)

  Ciphertext(tag, NONCE, ct)
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> to_fplll(matrix::<span class=hljs-built_in >AbstractMatrix</span>)
  ret = <span class=hljs-string >&quot;[&quot;</span>
  <span class=hljs-keyword >for</span> row <span class=hljs-keyword >in</span> eachrow(matrix)
    ret *= <span class=hljs-string >&quot;[&quot;</span> * join(string.(row), <span class=hljs-string >&quot; &quot;</span>) * <span class=hljs-string >&quot;]&quot;</span>
  <span class=hljs-keyword >end</span>
  ret *= <span class=hljs-string >&quot;]&quot;</span>

  ret
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> to_fplll(v::<span class=hljs-built_in >AbstractVector</span>)
  ret = <span class=hljs-string >&quot;[&quot;</span> * join(string.(v), <span class=hljs-string >&quot; &quot;</span>) * <span class=hljs-string >&quot;]&quot;</span>
  ret
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> from_fplll(v::<span class=hljs-built_in >AbstractString</span>)
  reshape(permutedims(Meta.eval(Meta.parse(v))), :)
<span class=hljs-keyword >end</span></code></pre> <p>Finally we pass our splitting ciphertexts to the oracle, and partition/binary-search our way through the key space.</p> <pre><code class="julia hljs"><span class=hljs-keyword >const</span> SELECT_TOKEN = <span class=hljs-string >&quot;1\n&quot;</span>
<span class=hljs-keyword >const</span> DECRYPT = <span class=hljs-string >&quot;2\n&quot;</span>
<span class=hljs-keyword >const</span> GET_FLAG = <span class=hljs-string >&quot;3\n&quot;</span>

<span class=hljs-keyword >function</span> writeafter(process, delimiter, towrite)
  print(readuntil(process, delimiter))
  write(process, towrite)
<span class=hljs-keyword >end</span>

<span class=hljs-keyword >function</span> valid_ciphertext(server_process, ciphertext)
  writeafter(server_process, <span class=hljs-string >&quot;&gt;&gt;:&quot;</span>, DECRYPT)
  writeafter(
    server_process,
    <span class=hljs-string >&quot;:&quot;</span>,
    bytes2hex([ciphertext.nonce; ciphertext.ciphertext; ciphertext.tag]) * <span class=hljs-string >&quot;\n&quot;</span>,
  )

  result = <span class=hljs-built_in >String</span>(readuntil(server_process, <span class=hljs-string >&quot;\n&quot;</span>))
  print(result)
  <span class=hljs-keyword >if</span> occursin(<span class=hljs-string >&quot;decrypted&quot;</span>, result)
    <span class=hljs-keyword >return</span> <span class=hljs-literal >true</span>
  <span class=hljs-keyword >end</span>
  <span class=hljs-keyword >return</span> <span class=hljs-literal >false</span>
<span class=hljs-keyword >end</span>


server_process = open(<span class=hljs-string >`python server.py`</span>; read = <span class=hljs-literal >true</span>, write = <span class=hljs-literal >true</span>)
full_token = <span class=hljs-string >&quot;&quot;</span>
<span class=hljs-keyword >for</span> token_idx = <span class=hljs-number >1</span>:<span class=hljs-number >6</span>
  writeafter(server_process, <span class=hljs-string >&quot;&gt;&gt;:&quot;</span>, SELECT_TOKEN)
  writeafter(server_process, <span class=hljs-string >&quot;&gt;&gt;:&quot;</span>, <span class=hljs-string >&quot;<span class=hljs-variable >$token_idx</span>\n&quot;</span>)

  tree = <span class=hljs-literal >nothing</span>
  <span class=hljs-keyword >for</span> t <span class=hljs-keyword >in</span> forest
    <span class=hljs-keyword >if</span> valid_ciphertext(server_process, t.splitting)
      tree = t
      <span class=hljs-keyword >break</span>
    <span class=hljs-keyword >end</span>
  <span class=hljs-keyword >end</span>

  t = tree
  <span class=hljs-keyword >while</span> !isnothing(t.lo) &amp;&amp; !isnothing(t.hi)
    <span class=hljs-keyword >if</span> valid_ciphertext(server_process, t.hi.splitting)
      t = t.hi
    <span class=hljs-keyword >elseif</span> valid_ciphertext(server_process, t.lo.splitting)
      t = t.lo
    <span class=hljs-keyword >else</span>
      error(<span class=hljs-string >&quot;Neither subtree contained a valid key&quot;</span>)
    <span class=hljs-keyword >end</span>
  <span class=hljs-keyword >end</span>
  full_token *= only(t.keys).raw
<span class=hljs-keyword >end</span>

writeafter(server_process, <span class=hljs-string >&quot;&gt;&gt;:&quot;</span>, GET_FLAG)
write(server_process, full_token * <span class=hljs-string >&quot;\n&quot;</span>)

flag = read(server_process, <span class=hljs-built_in >String</span>)
<span class=hljs-meta >@show</span> flag</code></pre> <h3 id=flag ><a href="#flag" class=header-anchor >Flag</a></h3> <pre><code class="plaintext hljs">flag = &quot; enter token: nite{p@dd1nG...umm..n0..p@rT1tI0niNg_oR4cL3s_ftw}\n&quot;</code></pre>
<p></p>
<div class=page-foot >
    Last modified: February 02, 2024.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div>
        </div> 
    </div> 
    
        



    
    
        <script src="/wednesday-acapella/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>